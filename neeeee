SELECT ref_no, doc_id, doc_edms_map, file_name, id_no, ckyc_no, cersai_flag, archival_flag, doc_type, scanned_dt, doc_code, doc_category, doc_identifier, doc_expiry_date, cmmnts, file_path, crtd_by, updtd_by, crtd_dt, updtd_dt
	FROM yono_dcmnt.edms_doc_dtls

SELECT ref_no, channel_id, no_of_poa, no_of_poi, no_of_kyc, no_of_others, upload_status, response_status, doc_uplaod_path, crtd_by, updtd_by, crtd_dt, updtd_dt
		FROM yono_dcmnt.edms_upload_doc 

SELECT ref_no, cif, accnt_no, ppf_accnt_no, vrtl_card_nm, physcl_card_nm, ntwrk_typ_physcl_card, ntwrk_typ_vrtl_card, jrnl_nmbr_nominee, jrnl_nmbr_physcl, jrnl_nmbr_sms_alert, jrnl_nmbr_tmp_add, amlock_dtls, jrnl_nmbrs_chq, upi_id, jrnl_nmbr_ckyc, rghts_lvl, jrny, crtd_dt, updtd_dt, crtd_by, updtd_by
	FROM yono_accnt.accnt_onbrdng_status;


	@Override
	public List<EtbTriggerDto> read() throws UnexpectedInputException, ParseException, ServiceBusinessException {
		if (finished) {
			return null;
		}
		String sql = new StringBuilder().append(" ").append(pagesize).toString();



______
SELECT
    d.ref_no,

    ARRAY_AGG(d.file_path ORDER BY d.doc_edms_map)    AS file_paths,
    ARRAY_AGG(d.doc_edms_map ORDER BY d.doc_edms_map) AS doc_names,

    u.channel_id,
    u.upload_status,
    u.doc_uplaod_path,

    a.cif,
    a.accnt_no,
    a.ppf_accnt_no,
    a.upi_id,
    a.jrny

FROM yono_dcmnt.edms_doc_dtls d

JOIN yono_dcmnt.edms_upload_doc u
     ON d.ref_no = u.ref_no
    AND u.upload_status = false

LEFT JOIN yono_accnt.accnt_onbrdng_status a
       ON d.ref_no = a.ref_no

GROUP BY
    d.ref_no,
    u.channel_id,
    u.upload_status,
    u.doc_uplaod_path,
    a.cif,
    a.accnt_no,
    a.ppf_accnt_no,
    a.upi_id,
    a.jrny

ORDER BY d.ref_no;




qqqqq
SELECT
    u.ref_no,

    ARRAY_AGG(d.file_path ORDER BY d.doc_edms_map)    AS file_paths,
    ARRAY_AGG(d.doc_edms_map ORDER BY d.doc_edms_map) AS doc_names,

    u.channel_id,
    u.upload_status,
    u.doc_uplaod_path,

    a.cif,
    a.accnt_no,
    a.ppf_accnt_no,
    a.upi_id,
    a.jrny

FROM yono_dcmnt.edms_upload_doc u

INNER JOIN yono_dcmnt.edms_doc_dtls d
        ON u.ref_no = d.ref_no

LEFT JOIN yono_accnt.accnt_onbrdng_status a
       ON u.ref_no = a.ref_no

WHERE u.upload_status = false
  AND u.channel_id IN ('Y2EDNRI', 'Y2NRI', 'Y2ETB')   -- configurable

GROUP BY
    u.ref_no,
    u.channel_id,
    u.upload_status,
    u.doc_uplaod_path,
    a.cif,
    a.accnt_no,
    a.ppf_accnt_no,
    a.upi_id,
    a.jrny

ORDER BY u.ref_no;